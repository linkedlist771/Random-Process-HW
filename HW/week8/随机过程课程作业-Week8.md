

# 随机过程课程作业-**Week8**

**作者**：48-丁力-202328015926048  
**日期**：今天

---

## 目录

- [马尔科夫过程](#马尔科夫过程)
  - [题目5](#题目1)
  - [题目6](#题目2)
  - [题目7](#题目3)
  - [题目8](#题目4)

---

## 马尔科夫过程

### 题目5

设有一个三个状态 $S=\{0,1,2\}$ 的齐次马氏链, 它一步转移梳率矩阵为:
$$
P=\left(\begin{array}{ccc}

p_1 & q_1 & 0 \\

0 & p_2 & q_2 \\

q_3 & 0 & p_3

\end{array}\right)
$$


试求:

- (1) $f_{00}^{(1)}, f_{00}^{(2)}, f_{00}^{(3)}, f_{01}^{(1)}, f_{01}^{(2)}, f_{01}^{(3)}$

> ~~为了计算这些`n`步返回概率，对于齐次马尔科夫链，我们直接计算$P^n$即可。~~
>
> 首先，我之前犯了个错，没有区分出来$f_{ij}^{(n)}$ 和$q_{ij}^{(n)}$ 的区别， 这里区分一下， 前者表示n步从i状态到j状态的概率，后者也是，但是`后者不要求路径是否经j`， 前者要求`不能经过j`。
>
> 那么为了计算这几个值，首先我们需要画出其状态转移图：
>
> ```mermaid
> graph TD
>     0 -->|p1| 0
>     0 -->|q1| 1
>     1 -->|p2| 1
>     1 -->|q2| 2
>     2 -->|q3| 0
>     2 -->|p3| 2
> 
> ```
>
> 那么，我们可以计算得到上述内容为：
> $$
> \begin{align}
> f_{00}^{(1)} &= p_1\\
> f_{00}^{(2)} &= 0\\
> f_{00}^{(3)} &= q_1q_2q_3\\ 
> f_{01}^{(1)} &= q_1 \\
> f_{01}^{(2)} &= q_1p_2 \\
> f_{01}^{(3)} &=  q_1p_1^2
> \end{align}
> $$
> 
>
> 

- (2) 确定状态分类，哪些属于常返的，哪些属于非常返的。

> - **相通状态（Communicating States）**：
>   - 从图中可以看出：
>     - 从状态1可以通过一个边到达状态2，但无法到达状态3。
>     - 从状态2可以通过一个边到达状态3，但无法直接到达状态1。
>     - 从状态3可以通过一个边到达状态1，但无法直接到达状态2。
>   - 因此，所有的状态都是相通的。
> 2. **非周期状态（Aperiodic States）**：
>    - 由于每个状态都有一个指向自己的边（表示每个状态都有一个非零的概率在下一步返回到自身），所有的状态都是非周期的。
>
> 3. **正常返状态（Positive Recurrent States）**：
>    - 如前所述，每个状态都有一个非零的概率在有限的步数内返回到该状态，因此每个状态都是正常返的。
>
> 4. **遍历状态（Ergodic States）**：
>    - 由于每个状态都是非周期的和正常返的，所以每个状态都是遍历的。
>

### 题目6

试确定下列齐次马氏链的状态分类, 哪些属于常返的, 那些些属于非常返的. 已知该链的一步转移矩阵为:

(1) $P=\left(\begin{array}{lll}p_{00} & p_{01} & p_{02} \\ p_{10} & p_{11} & p_{12} \\ p_{20} & p_{21} & p_{22}\end{array}\right)=\left(\begin{array}{ccc}0 & 1 / 2 & 1 / 2 \\ 1 / 2 & 0 & 1 / 2 \\ 1 / 2 & 1 / 2 & 0\end{array}\right)$;

(2) $P=\left(\begin{array}{lllll}p_{00} & p_{01} & p_{02} & p_{03} & p_{04} \\ p_{10} & p_{11} & p_{12} & p_{13} & p_{14} \\ p_{20} & p_{21} & p_{22} & p_{23} & p_{24} \\ p_{30} & p_{31} & p_{32} & p_{33} & p_{34} \\ p_{40} & p_{41} & p_{42} & p_{43} & p_{44}\end{array}\right)=\left(\begin{array}{ccccc}1 / 2 & 0 & 1 / 2 & 0 & 0 \\ 1 / 4 & 1 / 2 & 1 / 4 & 0 & 0 \\ 1 / 2 & 0 & 1 / 2 & 0 & 0 \\ 0 & 0 & 0 & 1 / 2 & 1 / 2 \\ 0 & 0 & 0 & 1 / 2 & 1 / 2\end{array}\right)$;

(3) $P=\left(\begin{array}{lllll}p_{00} & p_{01} & p_{02} & p_{03} & p_{04} \\ p_{10} & p_{11} & p_{12} & p_{13} & p_{14} \\ p_{20} & p_{21} & p_{22} & p_{23} & p_{24} \\ p_{30} & p_{31} & p_{32} & p_{33} & p_{34} \\ p_{40} & p_{41} & p_{42} & p_{43} & p_{44}\end{array}\right)=\left(\begin{array}{ccccc}1 / 4 & 3 / 4 & 0 & 0 & 0 \\ 1 / 2 & 1 / 2 & 0 & 0 & 0 \\ 0 & 0 & 1 & 0 & 0 \\ 0 & 0 & 1 / 3 & 2 / 3 & 0 \\ 1 & 0 & 0 & 0 & 0\end{array}\right)$.

> (1):
>
> 画出其状态转移图如下：
>
> ```mermaid
> graph TD
>     0 -->|1/2| 1
>     0 -->|1/2| 2
>     1 -->|1/2| 0
>     1 -->|1/2| 2
>     2 -->|1/2| 0
>     2 -->|1/2| 1
> 
> ```
>
> 由于三个状态都是相同的，所以这个是正常返的。
>
> (2):
>
> 画出其状态转移图如下：
>
> ```mermaid
> graph TD
>     0 -->|1/2| 0
>     0 -->|1/2| 2
>     1 -->|1/4| 0
>     1 -->|1/2| 1
>     1 -->|1/4| 2
>     2 -->|1/2| 0
>     2 -->|1/2| 2
>     3 -->|1/2| 3
>     3 -->|1/2| 4
>     4 -->|1/2| 3
>     4 -->|1/2| 4
> 
> ```
>
> 容易看出，这个图是不联通的，所以部分，所以分为左右两个来区分，对于右边的子图，3和4是连通的，所以3和4是正常返回的， 在左图中，0和2是正常返的， 从1出发到达0和2的无法返回1，所以1是非常返的。
>
> (3):
>
> 画出状态转移图如下：
>
> ```mermaid
> graph TD
>     0 -->|1/4| 0
>     0 -->|3/4| 1
>     1 -->|1/2| 0
>     1 -->|1/2| 1
>     2 -->|1| 2
>     3 -->|1/3| 2
>     3 -->|2/3| 3
>     4 -->|1| 0
> 
> ```
>
> 同上分析，我们可以得到：
>
> > 0  正常返
> >
> > 1: 正常返
> >
> > 2：正常返
> >
> > 3：非正常返
> >
> > 4：非正常返



### 题目7

设具有三个状态的齐次马氏链的一步转移枚率矩阵为:
$$
P=\left(\begin{array}{lll}

p_{00} & p_{01} & p_{02} \\

p_{10} & p_{11} & p_{12} \\

p_{20} & p_{21} & p_{22}

\end{array}\right)=\left(\begin{array}{lll}

1 / 2 & 0 & 1 / 2 \\

1 / 3 & 0 & 2 / 3 \\

1 / 4 & 0 & 3 / 4

\end{array}\right)
$$




(a) 求 3 步首达概率 $f_{02}^{(3)}$;

（b）写出三个状态的常返性、周期性; 此链是否遍历? 说明理由.

> (1):walking:
>
> 首先，我们给出其状态转移图：
>
> ```mermaid
> graph TD
>  0 -->|1/2| 0
>  0 -->|1/2| 2
>  1 -->|1/3| 0
>  1 -->|2/3| 2
>  2 -->|1/4| 0
>  2 -->|3/4| 2
> 
> ```
>
> 从上图容易看出，三步首达概率为:
> $$
> f_{02}^{(3)} = p_{00} p_{00}p_{02} = \frac{1}{2}^2 \times \frac{1}{2 } = \frac{1}{8}
> $$
>
>
> (2)
>
> 从上状态转移图容易看出：
>
> > 0： 常返态
> >
> > 1： 非常返态
> >
> > 2： 常返
>
> 对于状态1， 从1出发无法返回1，所以1是非周期的， 由于0和2状态都有自环，所以也是非周期性的。
>
> 对于任意正整数`n`，$P^n$第二列均为0， 所以该马尔科夫链是非遍历的。



## 题目8

设 $\left\{X_n ; n=0,1,2, \cdots\right\}$ 是一齐次马氏链, 其初始分布为
$$
P\left\{X_0=0\right\}=p_0, P\left\{X_0=1\right\}=p_1, P\left\{X_0=2\right\}=p_2, P\left\{X_0=3\right\}=p_3
$$


一步转移概率矩阵为:
$$
P=\left(\begin{array}{llll}

p_{00} & p_{01} & p_{02} & p_{03} \\

p_{10} & p_{11} & p_{12} & p_{13} \\

p_{20} & p_{21} & p_{22} & p_{23} \\

p_{30} & p_{31} & p_{32} & p_{33}

\end{array}\right)=\left(\begin{array}{cccc}

0 & 1 / 2 & 0 & 1 / 2 \\

0 & 0 & 1 & 0 \\

0 & 0 & 0 & 1 \\

1 / 2 & 0 & 0 & 1 / 2

\end{array}\right)
$$

- (1) 试求概率 $P\left\{X_0=0, X_1=1, X_2=1\right\}$;
- (2) 计算 $p_{01}^{(2)}$;
- (3) 试求首达概率 $f_{00}^{(n)}, n=1,2,3, \cdots$;
- (4) 写出四个状态的常返性、周期性; 此链是否遍历? 说明理由。

> - (1): 
>
> 这个概率可以用条件全概率计算得到：
> $$
> \begin{align}
> P\left\{X_0=0, X_1=1, X_2=1\right\} &= P\left\{X_0=0\right\} P_{01}P_{11} \\
> &= p_0\times 1/2 \times 0 \\
> &= 0
> \end{align}
> $$
>
> - (2):
>
> 这个可以通过$P^2$计算得到， 首先我们计算$P^2$:
> $$
> p^2 =\left(\begin{array}{cccc}
> \frac{1}{4} & 0 & \frac{1}{2} & \frac{1}{4} \\
> 0 & 0 & 0 & 1 \\
> \frac{1}{2} & 0 & 0 & \frac{1}{2} \\
> \frac{1}{4} & \frac{1}{4} & 0 & \frac{1}{2}
> \end{array}\right)
> $$
> 那么，我们有:
> $$
> p_{01}^{(2)} = 0
> $$
>
> - (3)
>
> 画出其状态转移图：
>
> ```mermaid
> graph TD
>     0 -->|1/2| 1
>     0 -->|1/2| 3
>     1 -->|1| 2
>     2 -->|1| 3
>     3 -->|1/2| 0
>     3 -->|1/2| 3
> 
> ```
>
> 所以有:
> $$
> f_{00}^{(n)} = \begin{cases}
> 0, n=1\\
> (1/2)^2, n=2\\
> (1/2)^3, n=3\\
> (1/2)^n + (1/2)^{n-2}, n\geq 4
> \end{cases}
> $$
>
> - （4）
>
> 由于该图是连通的，所以这个是正常返的， 由于都是非周期的，并且是遍历的。
>
> 
>





